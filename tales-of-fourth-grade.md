Architectural Kata: *Tales Of A Fourth Grade*
## Сбор и анализ требований (Россия, 2025 г.)
*Отчёт составил: Мишин Григорий · апрель 2025*

> **Суть задачи.** Построить SaaS‑платформу для начальной школы, которая ведёт учёт посещаемости, опозданий и заявлений об отсутствии, хранит оценки и задания, организует канал «родитель‑учитель» и формирует отчёты.  
> **Пользователи:** преподаватели, административный персонал и родители.

---

### 1. Отсев
Я разделил требования на обязательные для MVP и *nice‑to‑have*‑функции. Критически важны учёт посещаемости, оценок и заданий. Форум «родитель‑учитель» оставил в бэклоге как дифференцирующую, но не критичную функцию. Всё, что не связано напрямую с учётом ученика (бухгалтерия, логистика и т. д.), исключил из объёма.

**Ключевые ответы стейкхолдеров:**
- «Если не автоматизируем, будем терять данные и время — родители жалуются, Рособрнадзор штрафует».  
- «Успех измерим тем, что не менее 80 % школ‑пилотов перейдут на систему за три месяца».

---

### 2. Scope Refinement
Зафиксировал, что это единая SaaS‑платформа для учёта учебной активности. Масштабируемся от 1‑го до 11‑го класса, но в MVP фокусируемся на начальной школе. На старте внедряем: посещаемость, задания, оценки, коммуникацию и отчёты. Интеграции с «ЭлЖур/МЭШ» заношу в риск‑лист для следующих фаз.

---

### 3. Функциональные требования
| ID | Функция | Акторы | Приоритет |
|----|---------|--------|-----------|
| **FR‑01** | Фиксация посещаемости, опозданий и заявлений об отсутствии | Учитель | **MVP** |
| **FR‑02** | Форма «Подать заявление об отсутствии» с возможностью прикрепить файл | Родитель | **MVP** |
| **FR‑03** | Хранение профилей учеников (ФИО, класс, контакты, фото) | Администратор | **MVP** |
| **FR‑04** | Публикация заданий, приём решений, выставление оценок | Учитель, Родитель | **MVP** |
| **FR‑05** | Генерация PDF/HTML‑отчётов по ученику или классу | Администратор | **MVP** |
| **FR‑06** | Форум/чат «родитель‑учитель» | Учитель, Родитель | *Later* |
| **FR‑07** | Ролевое разграничение доступа | Все | **MVP** |

**Use‑case «Подать заявление об отсутствии»**  
Родитель заходит в личный кабинет, выбирает ребёнка, указывает причину отсутствия и при необходимости прикрепляет скан справки. Система уведомляет классного руководителя, который подтверждает или отклоняет заявку.

**Use‑case «Добавить задание и оценку»**  
Учитель создаёт задание с дедлайном и назначает его нужным классам. После сдачи просматривает работы в системе и выставляет оценки, которые тут же видит родитель.

---

### 4. Нефункциональные требования
| Категория | Целевое значение |
|-----------|-----------------|
| **Производительность** | p99 ≤ 500 мс на запись, p99 ≤ 200 мс на чтение при 10 000 RPS |
| **Масштабируемость** | Горизонтальный рост до 1 млн учеников |
| **Доступность** | 99,9 % в учебное время |
| **Безопасность** | Соответствие ФЗ‑152; двухфакторная авторизация для учителей |
| **Регуляторика** | Данные хранятся в РФ; шифрование по ГОСТ |
| **UX** | PWA с офлайн‑кэшем 15 мин (площадка) |
| **Мониторинг** | Prometheus + Grafana; аудит действий |

---

### 5. Ограничения
1. **Импортозамещение:** отечественные или open‑source решения с локальной поддержкой.  
2. **Бюджет MVP:** ≤ 5 млн ₽.  
3. **Срок пилота:** 6 месяцев (запуск 1 сентября 2025).  
4. **Облако:** Яндекс.Облако или Ростелеком Cloud.  
5. **Технологии:** Java 19 / Spring Boot, PostgreSQL 15, фронт — Vue 3 (PWA).

---

### 6. Расчёт нагрузки
#### Пользователи и RPS
- Ученики — 1 000 000.  
- Родители — ≈ 3 000 000.  
- Пиковая одновременная активность — 10 % (≈ 300 000 пользователей).  
- При 1–2 запросах в секунду получаем 5 000–10 000 RPS; планирую **15 000 RPS** с запасом.

#### Объём БД на старте
| Таблица | Записей | Средний вес | Объём |
|---------|---------|-------------|-------|
| Student | 1 000 000 | 100 Б | 0,1 ГБ |
| Attendance | 200 000 000 | 100 Б | 20 ГБ |
| Grades | 50 000 000 | 100 Б | 5 ГБ |
| Assignments | 20 000 000 | 100 Б | 2 ГБ |
| Excuses | 100 000 | 1 КБ | 0,1 ГБ |
| **Всего** | — | — | **≈ 27 ГБ** |

Прирост 10–20 ГБ/год ⇒ шардинг по школам.

---

### 7. Глоссарий
**Student, Teacher, Parent, Class, Attendance, Excuse, Assignment, Grade, Account** — базовые сущности системы.

---

### 8. AS‑IS / TO‑BE
- **AS‑IS:** бумажные журналы, Excel, сообщения в мессенджерах.  
- **TO‑BE:** единый портал: родитель подаёт заявление об отсутствии онлайн → учитель подтверждает → данные сразу попадают в БД; задания и оценки ведутся цифрово; отчёты формируются автоматически; чат встроен.

---

### 9. Выбор технологий
- **Backend:** Java 19 / Spring Boot.  
- **Database:** PostgreSQL 15, кластер Patroni.  
- **Frontend:** Vue 3 PWA.  
- **Async:** RabbitMQ.  
- **Object Storage:** MinIO (S3‑совместимый).  
- **Hosting:** Яндекс.Облако, сертифицированное под ФЗ‑152.  
Весь стек либо open‑source, либо имеет поддержку в РФ.

---

### 10. PlantUML‑диаграмма 

![image](https://github.com/user-attachments/assets/64b4cc43-51b5-4772-beab-7bb5b9bab83d)


---

### Вывод
MVP укладывается в 6 месяцев и 5 млн ₽. Основные риски — регуляторика и обучение пользователей. Данные локализованы, трафик и БД масштабируются линейно. Проект готов к пилоту на 100 школ.

