# Базы данных

---

## Выбор БД

### Диаграмма

![image](https://github.com/user-attachments/assets/42dac234-49b9-4158-99b7-f037b6208959)


### Пояснения

| Сервис                             | Тип                      | Обоснование выбора                                                                                                                                                                                     |
| ---------------------------------- | ------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Booking Service (покупка билетов)  | Реляционная (PostgreSQL) | Здесь важна точность операций: билет не может быть продан дважды, нужна чёткая работа с транзакциями, чтобы одновременно несколько покупателей не могли купить одно и то же место                     |
| Ticket Service (работа с билетами) | Реляционная (PostgreSQL) | Стандартные CRUD операции, транзакционность, нет потребности в NOSQL базе                                     |
| Event Service (события)            | Реляционная (PostgreSQL) | Аналогично, за исключением того, что данные дополнительно будут кэшироваться. В 90% случаев запросы направятся в Redis, а в 10% случаев (если кэш пуст или устарел), читаем данные из PostgreSQL, формируем свежий ответ и кладем его в Redis на будущее                                                                                         |
| Artist Service (артисты)           | Реляционная (PostgreSQL) | Стандартные CRUD операции, транзакционность, нет потребности в NOSQL базе                                                                                              |
| User Service (пользователи)        | Реляционная (PostgreSQL) | Стандартные CRUD операции, транзакционность, нет потребности в NOSQL базе                                                      |
| Notification Service (уведомления) | Реляционная (PostgreSQL) | Стандартные CRUD операции, транзакционность, нет потребности в NOSQL базе                                                                                   |
| Redis (кэш для событий)            | Redis   | Список событий будем кэшировать на короткий срок для ускорения работы сайта в пиковые моменты, тем самым можно будет отфильтровать часть запросов. Новые события появляются не так часто. Будет уместно кэшировать как минимум на минуту |

---

## Репликация

Для всех реляционных баз данных (PostgreSQL) будет использоваться стандартная схема с основным сервером и его копиями:

* Все записи и обновления происходят на мастер-узле
* Для чтения данных (например, для административной панели или для отчетов) будут использоваться реплики
* При больших нагрузках не будет перегружаться мастер и при этом данные всегда были актуальны
* Если основной сервер выйдет из строя, можно будет быстро переключиться на одну из реплик

---

## Шардинг

На текущем этапе проекта разделение данных на отдельные группы (шардинг) не применимо, вся информация хранится централизованно.
Если в будущем система сильно масштабируется, можно будет рассмотреть возможность разнести данные по разным серверам, например, по разным событиям или по пользователям.
